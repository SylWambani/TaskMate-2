<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Your Tasks</title>
</head>
<body>
  <h1>My Tasks</h1>
  <div id="task-container"></div>

  <script>
    async function loadTasks() {
      const token = localStorage.getItem('access_token');
      if (!token) {
        alert("Not logged in.");
        window.location.href = "/"; // go back to login
        return;
      }

      const response = await fetch('/tasks/', {
        method: 'GET',
        headers: {
          'Authorization': `Bearer ${token}`,
          'Content-Type': 'application/json'
        }
      });

      if (response.ok) {
        const tasks = await response.json();
        const container = document.getElementById('task-container');
        container.innerHTML = '';
        
        if (tasks.length === 0) {
          container.innerHTML = '<p>No tasks found.</p>';
          return;
        }

        tasks.forEach(task => {
          const item = document.createElement('p');
          item.textContent = `${task.title} - ${task.completed ? 'Done' : 'Pending'}`;
          container.appendChild(item);
        });
      } else {
        alert("Failed to load tasks. Unauthorized?");
      }
    }

    // üîÅ Trigger it when page loads
    window.onload = loadTasks;
  </script>
</body>
</html>
